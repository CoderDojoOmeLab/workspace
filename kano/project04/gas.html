<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>スプレッドシートを操作する</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>

<body>
  <h1>ワークシートの値を表示したい</h1>
  <pre><div id="sheetData"></div></pre>

<script type="text/javascript">
  // REST-API 呼び出し初期化用のパラメーター

  // 案１
  // Fetch API, DevTools のコンソールでリクエスト送信すると結果が返ってくる。.text(), .json()は置き換え可能。
  //(await fetch (
  //  `https://sheets.googleapis.com/v4/spreadsheets/1pHhono-TanTsOU4uj-jQhOhXQyiaFvgx00SUQiDQG94/values/%E5%B9%B4%E9%BD%A2%E5%88%A5%E4%BA%BA%E5%8F%A3?key=AIzaSyDXJkmtujRmho-Xc9iP_pkENQbfipYkRyg`,
  //  {
  //    method: "GET"
  //  }
  //)).json();

  // 案２
  //let response = fetch (
  //  `https://sheets.googleapis.com/v4/spreadsheets/1pHhono-TanTsOU4uj-jQhOhXQyiaFvgx00SUQiDQG94/values/%E5%B9%B4%E9%BD%A2%E5%88%A5%E4%BA%BA%E5%8F%A3?key=AIzaSyDXJkmtujRmho-Xc9iP_pkENQbfipYkRyg`,
  //  {
  //    method: "GET"
  //  }
  //).then(function(data){
  //  console.log('httpレスポンス = '+data.status);
  //  let json = data.json()
  //  console.log(json);
  //}).catch(function(error) {
  //  console.log(error);
  //});

  // 案３
  async function getGoogleSpreadSheets() {
    let response = await fetch (
      `https://sheets.googleapis.com/v4/spreadsheets/1pHhono-TanTsOU4uj-jQhOhXQyiaFvgx00SUQiDQG94/values/%E5%B9%B4%E9%BD%A2%E5%88%A5%E4%BA%BA%E5%8F%A3?key=AIzaSyDXJkmtujRmho-Xc9iP_pkENQbfipYkRyg`,
      {
        method: 'GET'
      }
    ).then(response => response.json())

    //.then(data => print(data));
    // として関数を分けてもいい
    //function print(data) {
    //  console.log(data);
    //}

    .then(function(data){
      console.log(data);
      //document.getElementById('sheetData').innerHTML = JSON.stringify(data);
      document.getElementById('sheetData').innerHTML = JSON.stringify(data, null, 4);
    })

      // JSON.stringify … JSONオブジェクト[{a:0,b:1}]を、JSON文字列[{"a":0,"b":1}]に変換するメソッド
      // JSON.parse     … JSONを javascript で読み込む関数
  };

 
  getGoogleSpreadSheets();

</script>

</body>
</html>